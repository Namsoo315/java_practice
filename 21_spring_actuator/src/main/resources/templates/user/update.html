<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>회원수정</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<h1>회원수정 (PATCH)</h1>
<a href="/"> 돌아가기</a><br><br>

<form id="updateForm" onsubmit="return false;">
    <label>대상 id
        <input id="uid" type="number" value="1">
    </label><br>
    <label>email
        <input id="email" placeholder="변경 시에만 입력">
    </label><br>
    <label>nickname
        <input id="nickname" placeholder="변경 시에만 입력">
    </label><br>
    <label>password
        <input id="password" type="password" placeholder="변경 시에만 입력">
    </label><br>
    <label>birthday
        <input id="birthday" type="date">
    </label><br>
    <button type="button" onclick="updateUser()">수정</button>
</form>

<pre id="result"></pre>

<script>
    function updateUser() {
        const id = document.getElementById("uid").value;
        const body = {};

        const email = document.getElementById("email").value;
        if (email) body.email = email;

        const nickname = document.getElementById("nickname").value;
        if (nickname) body.nickname = nickname;

        const password = document.getElementById("password").value;
        if (password) body.password = password;

        const birthday = document.getElementById("birthday").value;
        if (birthday) body.birthday = birthday;

        axios.patch(`/api/v1/users/${id}`, body)
            .then(res => {
                document.getElementById("result").textContent =
                    "Status: " + res.status + "\n\n" + JSON.stringify(res.data, null, 2);
            })
            .catch(err => {
                if (err.response) {
                    document.getElementById("result").textContent =
                        "Error: " + err.response.status + "\n\n" + JSON.stringify(err.response.data, null, 2);
                } else {
                    document.getElementById("result").textContent = err.message;
                }
            });
    }
</script>
</body>
</html>
